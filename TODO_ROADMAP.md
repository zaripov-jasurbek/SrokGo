# SrokGo TODO Roadmap

> Живой план развития продукта (аналог Too Good To Go): что делать по шагам, что обязательно (must-have), что усиливает качество (best practices), и какие вопросы задавать перед реализацией.

---

## Как пользоваться этим документом

- Каждую задачу заводи как issue/ticket с оценкой (`S/M/L`) и сроком.
- Приоритеты:
  - `P0` — критично для запуска/денег/безопасности.
  - `P1` — сильно влияет на рост и удержание.
  - `P2` — улучшения и масштабирование.
- После каждого блока делай мини-ретро: что сработало, что тормозит, что переносим.

---

## Этап 0. Основа и стабильность (1–2 недели)

### Must-have (P0)
- [ ] Вынести конфиги в env (`MONGO_URI`, `JWT_SECRET`, `PORT`, `CORS_ORIGINS`).
- [ ] Подключить `@nestjs/config` и валидацию env через `class-validator`/`joi`.
- [ ] Перевести auth на полноценный `JWT + bcrypt` flow.
- [ ] Добавить глобальный `ValidationPipe` (`whitelist`, `forbidNonWhitelisted`, `transform`).
- [ ] Добавить единый формат ошибок и глобальный exception filter.
- [ ] Включить базовый rate limit на auth endpoints.

### Best practices
- [ ] Разделить `dev/stage/prod` окружения и переменные.
- [ ] Добавить health endpoints (`/health/live`, `/health/ready`).
- [ ] Добавить structured logging (request-id, user-id, latency).
- [ ] Настроить backup/restore policy для MongoDB.

### Перед реализацией спросить себя
- «Как лучше сделать ротацию секретов, чтобы не уронить авторизацию?»
- «Как лучше сделать миграцию пользователей на новый auth flow без потери сессий?»

---

## Этап 1. Кор-ценность для пользователя (2–4 недели)

### Must-have (P0/P1)
- [ ] Улучшить карточку пакета:
  - [ ] ожидаемый состав,
  - [ ] метки (вег/острое/без лактозы),
  - [ ] диапазон веса/порции,
  - [ ] таймер до конца выдачи.
- [ ] Прозрачные статусы заказа и таймлайн в API.
- [ ] Ограничения по no-show/частым отменам.
- [ ] Внедрить push/email уведомления по ключевым событиям заказа.
- [ ] Добавить обязательный пост-заказный фидбек (минимум 1 быстрый вопрос).

### Best practices
- [ ] Использовать идемпотентность для create order.
- [ ] Добавить soft-delete для важных сущностей.
- [ ] Логировать каждую смену статуса заказа (audit trail).
- [ ] Добавить feature flags для рискованных релизов.

### Перед реализацией спросить себя
- «Как лучше сделать UX статусов, чтобы снизить поддержку и путаницу?»
- «Как лучше сделать ограничения no-show — мягко для новых и строго для системных нарушителей?»

---

## Этап 2. Инструменты для бизнеса (2–4 недели)

### Must-have (P1)
- [ ] Кабинет заведения: остатки, активные пакеты, история заказов.
- [ ] Быстрое создание пакета по шаблонам.
- [ ] Управление окном выдачи (изменение времени/лимитов).
- [ ] Базовая аналитика:
  - [ ] продано пакетов,
  - [ ] no-show,
  - [ ] выручка,
  - [ ] средний чек.

### Best practices
- [ ] Рекомендовать цену по историческим данным (простая эвристика на старте).
- [ ] Добавить SLA-индикатор по скорости подтверждения заказа.
- [ ] Вести quality score заведения (доставка ожиданий, отзывы, отмены).

### Перед реализацией спросить себя
- «Как лучше сделать onboarding бизнеса, чтобы первая публикация пакета занимала < 5 минут?»
- «Как лучше сделать аналитику, чтобы владелец сразу понимал ценность сервиса?»

---

## Этап 3. Рост и удержание (3–6 недель)

### Must-have (P1)
- [ ] Подписки на заведения (follow/unfollow).
- [ ] Избранные и персонализированная выдача.
- [ ] Реферальная программа (пригласи друга).
- [ ] Сегментированные уведомления (любимая категория, радиус, время).
- [ ] Базовая anti-fraud логика на уровне заказов/аккаунтов.

### Best practices
- [ ] A/B тестирование офферов и текстов уведомлений.
- [ ] Cohort-анализ retention по неделям.
- [ ] Считать unit-экономику по сегментам (новые/возвращающиеся).

### Перед реализацией спросить себя
- «Как лучше сделать персонализацию без сложного ML на старте?»
- «Как лучше сделать реферальную механику, чтобы не было абьюза?»

---

## Этап 4. Социальный слой и доверие (опционально, P2)

### Must-have (P2)
- [ ] Ответы компании на отзывы.
- [ ] Лента активности (`/feed`) с релевантными событиями.
- [ ] Значки/достижения за экологический вклад.

### Best practices
- [ ] Модерация контента и жалобы.
- [ ] Репутационная система пользователей (вес отзывов).
- [ ] Публичная метрика impact (сколько еды «спасено»).

### Перед реализацией спросить себя
- «Как лучше сделать социальные функции, чтобы это помогало заказам, а не отвлекало?»
- «Как лучше сделать модерацию с минимальными ручными затратами?»

---

## Технический чеклист качества (сквозной)

### Must-have
- [ ] Unit + e2e тесты для auth, order state machine, comments.
- [ ] CI pipeline: lint, test, build.
- [ ] Базовые security проверки (dependency audit, headers, CORS).
- [ ] Swagger/OpenAPI актуален и покрывает новые endpoints.

### Best practices
- [ ] Контрактные тесты для критичных API.
- [ ] Нагрузочные тесты на пиковые сценарии (за 30–60 мин до закрытия дня).
- [ ] Sentry/аналог для ошибок продакшена.
- [ ] Метрики и дашборд (p95 latency, error rate, conversion).

---

## KPI, без которых нельзя оценить прогресс

### Must-have KPI
- [ ] Conversion в заказ (view → order).
- [ ] Repeat rate 30d.
- [ ] Order completion rate.
- [ ] No-show rate.
- [ ] Среднее время подтверждения заказа бизнесом.

### Best practices KPI
- [ ] LTV / CAC по каналам.
- [ ] Retention D7 / D30.
- [ ] Доля заказов из персонализации.
- [ ] NPS пользователей и бизнесов.

---

## Шаблон задачи (копируй для каждого пункта)

```md
### [Название задачи]
- Приоритет: P0/P1/P2
- Оценка: S/M/L
- Цель: (какую метрику улучшаем)
- Definition of Done:
  - [ ] API реализован
  - [ ] Тесты написаны
  - [ ] Документация обновлена
  - [ ] Логи/метрики добавлены
- Риски:
- Вопрос перед стартом: «Как лучше сделать это ... ?»
```

---

## Что спрашивать у себя перед каждым крупным релизом

- «Как лучше сделать это с минимальным риском для текущих заказов?»
- «Как лучше сделать это так, чтобы поддержка не росла вместе с трафиком?»
- «Как лучше сделать это измеримо: какая метрика изменится и на сколько?»
- «Как лучше сделать это так, чтобы бизнесы увидели выгоду в первые 7 дней?»

---

## Короткий 90-дневный план (если нужен старт “прямо сейчас”)

- **Месяц 1:** Этап 0 + критичные пункты Этапа 1.
- **Месяц 2:** Этап 2 + уведомления/персонализация.
- **Месяц 3:** Этап 3 + первые социальные и impact-фичи.

Главный принцип: сначала стабильность + доверие к качеству наборов, потом масштабирование через удержание и инструменты для бизнеса.
